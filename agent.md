# コーディングエージェント・プレイブック（テンプレート）

Codex などの AI 支援エンジニアに作業を依頼する前に、本テンプレートで役割と期待値を整理する。

## 1. ロール定義
- **エージェント名**：_例：Codex_
- **担当範囲**：_Flutter アプリ、Supabase Edge Functions など、変更を許可する領域_
- **除外範囲**：_触れてはならないディレクトリやサービス_

## 2. 参照情報
- **要件定義**：`docs/BATON_requirements_v8.5.md`
- **実装手引書**：`docs/BATON_implementation_guide_v1.0.md`
- **現行プラン**：`plan.md`
- **追加資料**：_デザインリンク、API ドキュメント、データセットなど_

## 3. 運用プリンシプル
1. Flow→Stock の一連の流れを最優先で完成させ、磨き込みは後回しにする。
2. RBAC / RLS は初期状態では厳しめに保ち、緩める際は明示的な承認を得る。
3. パイプラインを提案・変更する際は Mux / Gemini コスト前提を明記する。
4. 仮定やショートカットはすべて PR / サマリに記録し、追跡可能にする。

## 4. 環境とツール
- **リポジトリ構成**：_モノレポ or 分割構成と各ディレクトリの役割_
- **CLI / ツール**：_Flutter / Dart / supabase CLI / Node などのバージョン_
- **シークレット管理**：_`.env` やサービスロールキー、API トークンの受け渡し方法_

## 5. 推奨ワークフロー
1. **把握**：要件・プランを読み、理解内容を確認。
2. **設計**：データモデル、Edge Functions、UI 状態などのアプローチを整理。
3. **実装**：スコープを区切ってコミットし、差分をレビューしやすく保つ。
4. **テスト**：lint / テストを実行し、動作確認手順を残す。
5. **報告**：変更概要、ファイル参照、検証結果を日本語でまとめる。

## 6. 品質チェックリスト
- [ ] `CODEX_PROMPT.MD` で定義した成功基準を満たしている
- [ ] テスト・検証結果が記録されている
- [ ] セキュリティ（RLS / シークレット）が維持されている
- [ ] テレメトリ / メトリクスの監視が影響を受けていない、または更新済み
- [ ] ドキュメント（README, ランブック, ダッシュボード）が更新済み

## 7. エスカレーションとレビュー
- **レビュアー**：_担当レビューア一覧_
- **エスカレーション条件**：_例：スキーマ変更、新規インフラ追加、API 破壊的変更_
- **コミュニケーションチャネル**：_Slack チャンネル、Issue Tracker など_

このプレイブックをエンゲージメントごとに記入し、Codex が十分な文脈とガードレールの下で作業できるようにする。

