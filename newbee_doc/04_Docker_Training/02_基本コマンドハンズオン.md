# 02. 基本コマンドハンズオン ⌨️

実際にターミナルを叩いて、Dockerコンテナのライフサイクル（作成・起動・停止・破棄）を体感しましょう。

> [!NOTE]
> ターミナル（Mac）またはPowerShell（Windows）を開いて実行してください。
> Docker Desktopが起動している必要があります。

## 1. 動作確認
まずは、Dockerが正しく動いているか確認します。

```bash
docker version
```
バージョン情報が表示されればOKです。

## 2. Hello World コンテナの実行
Dockerの世界へようこそ！以下のコマンドを実行してください。

```bash
docker run hello-world
```

### 何が起きたのか？
1. **Unable to find image...**: ローカルに `hello-world` というイメージ（レシピ）がないとDockerが判断。
2. **Pulling from library...**: インターネット上の倉庫（Docker Hub）からイメージをダウンロード。
3. **Hello from Docker!**: イメージからコンテナを作成・起動し、メッセージを表示して終了。

## 3. コンテナの状態確認 (ps)
`run` したはずなのに、動いている気配がありません。プロセスを確認してみましょう。

```bash
# 現在起動中のコンテナを表示
docker ps
```
おそらく何も表示されない（ヘッダーのみ）はずです。
なぜなら、`hello-world` は「メッセージを表示して**直ちに終了する**」プログラムだからです。

終了したコンテナも含めて表示するには、`-a` (all) オプションをつけます。

```bash
# 終了したものも含めて全てのコンテナを表示
docker ps -a
```
ここに `Exited (0)` となっている `hello-world` がいるはずです。

## 4. 常駐型コンテナ (Nginx) を動かす
次は、Webサーバーである `nginx` (エンジンエックス) を動かしてみましょう。これは終了せずに動き続けます。

```bash
docker run -d -p 8080:80 --name my-webserver nginx
```

### オプションの解説
- `-d`: **Detached** モード。バックグラウンドで実行します（これがないとターミナルが占有されます）。
- `-p 8080:80`: **Port** フォワーディング。PCの「8080番ポート」へのアクセスを、コンテナの「80番ポート」に転送します。
- `--name my-webserver`: コンテナにわかりやすい名前をつけます（省略すると変な名前が自動でつきます）。

### ブラウザで確認
ブラウザで [http://localhost:8080](http://localhost:8080) にアクセスしてみてください。
"Welcome to nginx!" という画面が出れば成功です！
あなたのPCの中に、隔離されたWebサーバーが立ち上がっています。

## 5. 停止と削除
遊び終わったら片付けましょう。

### コンテナの停止 (stop)
```bash
docker stop my-webserver
```
`docker ps` で確認すると、消えているはずです（`docker ps -a` には残っています）。

### コンテナの破棄 (rm)
止めただけでは「停止したマシン」が残っています。完全に削除します。
```bash
docker rm my-webserver
```
これで `docker ps -a` からも消えました。

## 6. イメージの削除 (rmi)
コンテナ（料理）は消えましたが、ダウンロードしたイメージ（レシピ）はPCに残っています。

```bash
# 保存されているイメージ一覧を確認
docker images
```
`nginx` と `hello-world` があるはずです。

```bash
# イメージを削除
docker rmi nginx
```

## まとめ：Dockerライフサイクル
1. **Pull**: イメージを取得
2. **Run**: コンテナを作成・起動（Pullしてなければ自動でPull）
3. **Stop**: 実行を停止
4. **Rm**: コンテナを破棄
5. **Rmi**: イメージを削除

次は、自分でオリジナルのイメージを作る `Dockerfile` に挑戦します。

---

## 📚 用語集 (Glossary)

| 用語 | 意味 | 補足 |
|------|------|-----|
| **Pull (プル)** | イメージをDLする | ネットから手元へ |
| **Run (ラン)** | コンテナを作成して起動 | Create + Start |
| **Daemon (デーモン)** | 常駐プログラム | ここではバックグラウンド実行(`-d`)のこと |
| **Port Forwarding** | ポート転送 | 「PCの扉」と「コンテナの扉」を繋ぐ |
| **Interactive** | 対話モード | コンテナの中に入って操作すること |

## 🛠️ コマンド集 (Docker Basic)

| コマンド | 説明 |
|---|---|
| `docker run [image]` | コンテナを起動する（イメージがなければDLする） |
| `docker ps` | 起動中のコンテナ一覧を表示 |
| `docker ps -a` | 終了したコンテナも含めて一覧表示 |
| `docker stop [name]` | コンテナを停止する（データは消えない） |
| `docker rm [name]` | 停止したコンテナを削除する（データも消える） |
| `docker images` | ダウンロード済みのイメージ一覧 |
| `docker rmi [image]` | イメージを削除する |
